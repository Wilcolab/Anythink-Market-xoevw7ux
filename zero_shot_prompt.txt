/**
 * Converts a given string to snake_case.
 * @param {string} text - The input string.
 * @returns {string} The snake_cased string.
 */
function toSnakeCase(text) {
  return text
    .replace(/\s+/g, ' ')                // Replace multiple spaces with single space
    .trim()                              // Trim leading/trailing spaces
    .replace(/([a-z])([A-Z])/g, '$1_$2') // Add _ between camelCase
    .replace(/[\s\-]+/g, '_')            // Replace spaces and hyphens with _
    .toLowerCase();
}

// Example usage:
// console.log(toSnakeCase("Convert ThisText-to_snake case")); // convert_this_text_to_snake_case